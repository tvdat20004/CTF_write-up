from hashlib import sha256
from random import SystemRandom
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
from sage.all import *
m=100
n=100
q = 7
seed = [6, 80, 158, 13, 171, 216, 164, 5, 73, 233, 6, 213, 63, 162, 90, 63, 208, 245, 101, 11, 120, 95, 78, 145, 159, 108, 105, 252, 241, 124, 92, 120, 18, 177, 243, 237, 132, 103, 237, 11, 75, 141, 172, 208, 155, 47, 111, 59, 118, 209, 169, 81, 141, 236, 104, 131, 104, 194, 246, 232, 14, 246, 68, 172]
v = [3, 0, 2, 4, 6, 4, 4, 1, 0, 6, 4, 1, 6, 0, 1, 6, 4, 4, 4, 1, 0, 5, 4, 5, 6, 2, 5, 5, 1, 0, 2, 6, 3, 0, 3, 0, 0, 0, 2, 2, 2, 6, 4, 6, 6, 3, 2, 3, 1, 2, 3, 0, 6, 4, 3, 0, 0, 6, 2, 1, 1, 1, 3, 5, 5, 5, 0, 4, 1, 5, 2, 1, 3, 2, 1, 0, 6, 0, 6, 3, 3, 3, 5, 0, 4, 1, 0, 3, 3, 6, 1, 4, 4, 3, 6, 1, 1, 3, 3, 0]
coms = [[3, 1, 6, 1, 4, 6, 4, 1, 3, 5, 3, 1, 1, 6, 4, 0, 3, 5, 6, 3, 4, 4, 6, 4, 0, 1, 3, 5, 3, 0, 6, 1, 4, 3, 6, 6, 1, 2, 6, 2, 6, 4, 1, 4, 0, 5, 5, 3, 3, 5, 3, 1, 6, 0, 5, 1, 3, 6, 5, 3, 4, 5, 5, 4, 2, 3, 6, 4, 5, 5, 3, 4, 4, 0, 4, 3, 5, 1, 1, 6, 2, 5, 3, 5, 6, 6, 1, 3, 5, 2, 1, 1, 6, 5, 6, 4, 1, 5, 5, 0], [2, 3, 1, 0, 2, 3, 6, 2, 2, 6, 4, 0, 2, 6, 2, 5, 4, 0, 4, 1, 6, 4, 3, 4, 4, 1, 6, 3, 0, 0, 5, 0, 5, 5, 5, 5, 3, 3, 6, 3, 0, 4, 4, 2, 1, 0, 6, 0, 3, 0, 1, 1, 1, 3, 4, 4, 0, 3, 1, 5, 0, 0, 5, 0, 2, 2, 0, 5, 5, 2, 3, 4, 3, 6, 3, 3, 1, 0, 0, 3, 5, 6, 4, 2, 5, 0, 1, 5, 6, 1, 4, 2, 3, 0, 6, 5, 1, 5, 1, 4], [2, 4, 5, 4, 1, 1, 4, 5, 5, 4, 3, 1, 4, 3, 2, 3, 2, 4, 4, 2, 3, 0, 4, 1, 0, 6, 1, 6, 2, 6, 6, 3, 4, 0, 6, 3, 0, 0, 6, 3, 4, 4, 2, 4, 0, 5, 1, 4, 4, 6, 6, 3, 1, 0, 3, 0, 0, 1, 5, 0, 6, 0, 1, 3, 4, 0, 2, 6, 1, 0, 4, 1, 2, 3, 0, 2, 0, 3, 0, 2, 4, 6, 1, 6, 0, 1, 5, 5, 3, 3, 0, 4, 1, 6, 2, 4, 1, 4, 4, 0], [3, 5, 5, 0, 6, 0, 0, 5, 0, 6, 6, 0, 6, 0, 6, 3, 3, 4, 1, 3, 5, 2, 3, 6, 1, 0, 3, 5, 4, 3, 0, 5, 1, 2, 4, 0, 3, 4, 0, 0, 6, 0, 1, 5, 1, 5, 4, 1, 6, 6, 0, 4, 6, 1, 4, 2, 2, 4, 0, 1, 1, 1, 3, 5, 2, 5, 4, 4, 4, 3, 0, 2, 3, 5, 4, 5, 4, 6, 0, 2, 1, 2, 2, 6, 6, 5, 1, 0, 3, 0, 3, 3, 1, 1, 2, 5, 2, 4, 6, 0], [2, 6, 5, 6, 1, 6, 3, 4, 6, 1, 2, 5, 2, 3, 1, 1, 3, 4, 6, 5, 2, 4, 0, 0, 0, 1, 3, 2, 6, 5, 5, 1, 2, 6, 0, 3, 2, 1, 4, 0, 5, 3, 4, 6, 3, 1, 5, 5, 6, 6, 3, 0, 0, 5, 3, 3, 4, 4, 5, 1, 1, 0, 5, 6, 2, 6, 3, 0, 5, 2, 3, 2, 4, 3, 4, 4, 3, 3, 2, 4, 6, 0, 6, 5, 6, 1, 2, 3, 5, 1, 5, 3, 4, 6, 3, 6, 3, 1, 2, 6], [2, 0, 1, 2, 6, 0, 5, 6, 6, 3, 2, 6, 1, 1, 6, 5, 2, 4, 4, 2, 2, 2, 0, 6, 1, 5, 1, 1, 1, 6, 6, 5, 4, 3, 4, 5, 4, 0, 0, 4, 4, 4, 1, 0, 2, 0, 4, 5, 6, 5, 4, 2, 1, 0, 0, 4, 1, 4, 3, 6, 6, 1, 0, 5, 3, 4, 0, 5, 6, 6, 2, 4, 3, 3, 6, 6, 1, 3, 4, 3, 1, 4, 4, 5, 5, 3, 6, 5, 2, 3, 1, 2, 4, 5, 6, 3, 5, 4, 6, 3], [3, 0, 1, 4, 0, 4, 5, 3, 4, 2, 4, 6, 0, 2, 1, 5, 4, 1, 5, 3, 0, 2, 2, 0, 0, 4, 3, 2, 3, 5, 6, 0, 6, 3, 1, 4, 2, 6, 5, 0, 6, 3, 3, 2, 2, 4, 1, 3, 4, 0, 2, 5, 1, 0, 5, 1, 2, 5, 2, 3, 4, 4, 0, 0, 1, 4, 0, 1, 2, 2, 5, 2, 5, 0, 3, 4, 2, 6, 4, 5, 0, 2, 0, 6, 1, 4, 2, 2, 3, 3, 2, 4, 0, 1, 0, 2, 1, 2, 5, 3], [2, 1, 1, 6, 5, 2, 4, 6, 6, 5, 2, 3, 1, 5, 4, 2, 1, 4, 6, 1, 6, 4, 0, 2, 4, 5, 5, 2, 1, 6, 0, 6, 3, 3, 5, 5, 4, 3, 6, 2, 2, 5, 3, 4, 0, 1, 4, 4, 5, 3, 3, 1, 3, 5, 0, 4, 5, 3, 1, 6, 2, 6, 2, 3, 4, 4, 2, 6, 5, 1, 6, 0, 0, 5, 6, 6, 4, 4, 3, 4, 5, 4, 5, 5, 6, 0, 2, 0, 6, 1, 5, 5, 5, 5, 4, 4, 3, 1, 1, 6], [5, 4, 6, 1, 3, 2, 3, 3, 6, 4, 4, 4, 6, 2, 3, 0, 1, 3, 0, 4, 0, 2, 4, 6, 4, 0, 1, 3, 5, 3, 4, 0, 4, 4, 0, 1, 2, 5, 3, 3, 4, 3, 5, 6, 5, 2, 4, 5, 2, 3, 3, 3, 3, 2, 3, 3, 3, 1, 2, 0, 4, 2, 0, 6, 5, 1, 4, 2, 5, 4, 0, 3, 1, 2, 1, 4, 6, 0, 1, 4, 5, 3, 5, 6, 4, 6, 6, 6, 1, 4, 6, 1, 5, 6, 3, 3, 3, 0, 1, 2]]
tass = [[1, 4, 0, 6, 1, 2, 1, 3, 5, 5, 1, 1, 6, 4, 3, 5, 5, 3, 3, 2, 4, 6, 1, 3, 0, 1, 2, 5, 4, 4, 5, 4, 2, 3, 0, 6, 1, 3, 1, 4, 1, 3, 6, 6, 6, 2, 2, 3, 2, 3, 1, 2, 6, 3, 5, 1, 5, 4, 0, 0, 4, 2, 2, 4, 1, 5, 5, 2, 1, 5, 5, 2, 1, 1, 0, 5, 6, 2, 6, 4, 3, 2, 5, 5, 0, 6, 0, 6, 5, 0, 0, 4, 6, 0, 3, 0, 5, 5, 4, 0], [4, 4, 6, 5, 0, 3, 4, 4, 4, 2, 0, 1, 0, 5, 6, 2, 5, 4, 0, 2, 4, 6, 5, 1, 1, 2, 6, 1, 2, 3, 5, 3, 0, 3, 4, 1, 3, 3, 1, 6, 2, 3, 4, 2, 2, 2, 3, 0, 4, 6, 3, 1, 6, 0, 0, 6, 1, 4, 3, 4, 3, 2, 6, 0, 3, 4, 1, 2, 4, 4, 0, 5, 1, 1, 0, 0, 5, 1, 1, 1, 1, 2, 3, 1, 5, 4, 1, 0, 0, 3, 2, 3, 0, 4, 5, 6, 0, 6, 1, 0], [1, 1, 4, 5, 2, 1, 4, 6, 5, 1, 3, 1, 5, 4, 6, 3, 0, 6, 1, 6, 5, 0, 4, 6, 1, 6, 5, 5, 6, 1, 0, 5, 6, 6, 6, 3, 0, 0, 1, 5, 0, 6, 1, 5, 4, 5, 1, 5, 5, 2, 4, 3, 1, 0, 5, 0, 6, 3, 6, 6, 6, 1, 0, 1, 5, 1, 5, 4, 1, 6, 5, 6, 2, 0, 6, 5, 5, 2, 1, 3, 0, 4, 2, 1, 5, 6, 5, 3, 3, 1, 2, 3, 3, 5, 0, 3, 3, 2, 5, 2], [6, 0, 1, 1, 4, 5, 1, 5, 2, 1, 5, 0, 0, 5, 4, 0, 2, 5, 1, 2, 3, 6, 2, 4, 3, 4, 1, 4, 4, 2, 2, 2, 3, 1, 4, 0, 1, 5, 0, 2, 4, 2, 3, 4, 4, 6, 6, 1, 3, 4, 6, 2, 6, 3, 6, 5, 2, 1, 3, 3, 3, 4, 6, 0, 5, 6, 6, 2, 4, 5, 3, 5, 6, 2, 2, 5, 2, 1, 4, 6, 5, 1, 6, 4, 5, 5, 6, 0, 6, 2, 1, 5, 0, 0, 4, 4, 6, 0, 0, 5], [4, 0, 0, 0, 6, 0, 2, 1, 1, 0, 4, 5, 2, 4, 3, 2, 1, 6, 0, 6, 4, 5, 3, 1, 1, 4, 0, 5, 4, 4, 6, 4, 1, 1, 6, 3, 0, 4, 4, 2, 6, 0, 2, 3, 4, 6, 0, 3, 0, 3, 5, 2, 2, 2, 4, 4, 1, 2, 1, 1, 0, 2, 5, 4, 2, 3, 0, 0, 6, 1, 5, 5, 5, 3, 5, 4, 6, 2, 2, 0, 4, 3, 1, 3, 3, 5, 4, 0, 5, 6, 3, 3, 3, 5, 4, 6, 1, 4, 0, 2], [1, 6, 1, 0, 0, 2, 4, 0, 0, 1, 1, 0, 2, 3, 4, 5, 5, 0, 1, 5, 2, 4, 6, 6, 3, 5, 1, 6, 2, 1, 6, 4, 5, 0, 4, 0, 5, 0, 5, 4, 6, 3, 6, 0, 6, 0, 2, 6, 1, 1, 6, 4, 2, 6, 1, 4, 6, 0, 0, 2, 1, 3, 2, 1, 5, 1, 5, 3, 6, 2, 5, 1, 1, 3, 6, 5, 4, 1, 2, 5, 3, 4, 3, 6, 2, 2, 0, 4, 4, 5, 3, 2, 1, 6, 1, 3, 0, 0, 1, 2], [3, 0, 0, 6, 3, 3, 0, 1, 1, 4, 4, 4, 0, 1, 4, 6, 5, 4, 3, 3, 0, 5, 1, 2, 1, 5, 5, 3, 0, 0, 0, 6, 1, 2, 0, 3, 1, 4, 3, 3, 3, 3, 5, 5, 2, 2, 6, 4, 4, 0, 5, 6, 2, 2, 1, 0, 5, 4, 0, 1, 2, 2, 2, 6, 6, 6, 0, 4, 1, 6, 1, 5, 6, 3, 4, 6, 4, 2, 1, 5, 5, 6, 3, 6, 5, 3, 5, 2, 6, 5, 3, 2, 2, 2, 3, 2, 2, 2, 3, 1], [6, 0, 4, 6, 1, 6, 4, 1, 6, 4, 0, 1, 6, 5, 4, 3, 5, 6, 4, 5, 5, 5, 5, 4, 2, 0, 6, 6, 6, 5, 4, 3, 5, 1, 6, 6, 1, 4, 1, 4, 4, 2, 2, 1, 3, 6, 3, 2, 5, 1, 1, 2, 2, 0, 3, 1, 3, 6, 3, 1, 4, 0, 5, 5, 3, 3, 3, 2, 6, 0, 5, 0, 3, 1, 2, 6, 3, 5, 2, 4, 2, 1, 2, 2, 4, 1, 5, 4, 0, 2, 3, 0, 2, 0, 5, 4, 2, 4, 6, 1], [6, 6, 1, 5, 0, 4, 0, 3, 2, 5, 1, 0, 3, 3, 5, 1, 1, 1, 3, 3, 1, 4, 5, 4, 1, 2, 5, 5, 0, 5, 5, 0, 0, 4, 4, 5, 5, 5, 1, 0, 4, 0, 5, 6, 2, 5, 3, 5, 0, 2, 1, 4, 0, 1, 5, 2, 1, 0, 3, 0, 5, 6, 6, 2, 5, 3, 3, 3, 3, 1, 5, 4, 4, 3, 6, 3, 3, 6, 1, 6, 5, 4, 0, 5, 5, 4, 0, 0, 3, 4, 0, 1, 1, 4, 4, 1, 4, 2, 3, 0]]
verifs = [[3, 4, 6, 6, 2, 0, 2, 1, 4, 0, 5, 4, 1, 2, 4, 0, 3, 4, 3, 5, 6, 4, 3, 3, 4, 2, 0, 1, 4, 3, 6, 1, 2, 6, 5, 4, 3, 4, 3, 0, 4, 2, 0, 4, 1, 1, 3, 3, 1, 4, 2, 3, 6, 4, 3, 0, 0, 1, 5, 0, 0, 1, 1, 5, 5, 4, 4, 0, 4, 6, 4, 1, 1, 5, 5, 1, 1, 0, 2, 3, 4, 1, 6, 0, 4, 6, 5, 5, 5, 1, 6, 0, 1, 6, 2, 2, 0, 6, 3, 4], [0, 3, 4, 1, 1, 0, 2, 5, 5, 3, 2, 2, 2, 2, 3, 4, 5, 0, 0, 6, 6, 1, 2, 4, 2, 2, 5, 2, 0, 2, 5, 2, 4, 6, 3, 3, 4, 2, 0, 3, 2, 5, 1, 6, 1, 0, 3, 3, 5, 5, 6, 2, 1, 5, 5, 1, 4, 3, 5, 1, 6, 4, 4, 5, 0, 6, 1, 1, 1, 0, 5, 4, 6, 3, 5, 1, 6, 0, 6, 5, 2, 0, 0, 2, 0, 1, 3, 4, 3, 6, 4, 6, 3, 3, 5, 5, 6, 2, 1, 3], [3, 1, 3, 5, 4, 0, 6, 5, 3, 6, 5, 1, 1, 4, 5, 3, 2, 1, 4, 5, 2, 4, 3, 5, 3, 5, 5, 0, 5, 0, 3, 1, 4, 3, 1, 4, 3, 1, 1, 6, 3, 5, 6, 5, 4, 5, 4, 5, 3, 0, 4, 5, 2, 6, 5, 0, 5, 3, 2, 6, 3, 6, 3, 6, 4, 2, 0, 1, 2, 6, 5, 3, 6, 2, 3, 1, 6, 4, 6, 2, 1, 3, 3, 6, 4, 1, 2, 2, 6, 2, 3, 0, 0, 4, 2, 1, 5, 1, 3, 4], [4, 0, 4, 4, 0, 6, 6, 5, 2, 6, 5, 1, 0, 5, 3, 3, 1, 6, 5, 2, 5, 0, 6, 6, 6, 1, 5, 3, 5, 5, 0, 2, 4, 1, 5, 0, 4, 0, 5, 0, 6, 5, 3, 0, 1, 5, 2, 1, 6, 2, 3, 4, 4, 6, 5, 1, 0, 1, 0, 2, 6, 5, 4, 4, 1, 1, 6, 2, 5, 0, 5, 2, 6, 4, 3, 0, 4, 2, 4, 3, 2, 6, 1, 6, 5, 5, 4, 2, 2, 6, 6, 6, 2, 2, 0, 5, 1, 6, 6, 0], [1, 6, 1, 6, 0, 0, 4, 6, 0, 0, 1, 5, 2, 0, 3, 1, 2, 1, 1, 0, 5, 1, 0, 6, 5, 6, 1, 0, 2, 0, 3, 3, 1, 2, 3, 6, 6, 6, 2, 0, 6, 3, 1, 6, 6, 3, 4, 1, 2, 0, 5, 1, 6, 1, 2, 2, 2, 6, 0, 4, 4, 1, 2, 1, 0, 4, 5, 6, 1, 5, 4, 6, 5, 2, 3, 0, 2, 1, 3, 6, 2, 0, 3, 5, 6, 1, 6, 1, 2, 3, 4, 6, 3, 6, 0, 6, 6, 0, 5, 6], [6, 5, 4, 2, 5, 6, 5, 6, 1, 4, 2, 0, 6, 1, 6, 5, 3, 6, 1, 6, 1, 2, 3, 0, 0, 5, 5, 1, 6, 1, 1, 0, 2, 1, 3, 5, 5, 1, 0, 0, 5, 5, 0, 6, 6, 4, 3, 5, 3, 3, 1, 1, 6, 4, 1, 6, 1, 1, 6, 6, 3, 3, 0, 4, 3, 5, 5, 4, 5, 5, 3, 5, 2, 5, 5, 5, 4, 6, 2, 3, 3, 1, 1, 6, 4, 6, 0, 5, 6, 0, 6, 3, 6, 4, 0, 0, 2, 2, 1, 2], [3, 5, 5, 1, 5, 1, 4, 2, 0, 2, 3, 2, 6, 0, 2, 2, 5, 6, 2, 0, 0, 6, 5, 3, 4, 2, 4, 2, 4, 3, 1, 0, 6, 0, 5, 2, 1, 1, 3, 3, 5, 4, 5, 6, 6, 2, 4, 1, 1, 2, 4, 5, 2, 3, 4, 2, 3, 5, 1, 6, 6, 4, 4, 3, 4, 0, 1, 5, 0, 1, 0, 6, 2, 1, 1, 3, 4, 1, 4, 3, 5, 6, 3, 0, 5, 0, 3, 3, 3, 3, 4, 4, 5, 5, 0, 0, 6, 2, 1, 6], [6, 2, 3, 0, 3, 3, 3, 0, 5, 3, 1, 5, 0, 2, 3, 0, 2, 2, 5, 5, 6, 5, 1, 3, 4, 2, 0, 2, 3, 4, 1, 0, 3, 2, 4, 5, 3, 4, 2, 6, 6, 1, 2, 4, 5, 3, 1, 4, 3, 4, 5, 1, 3, 4, 5, 1, 1, 6, 6, 1, 0, 1, 5, 3, 3, 4, 5, 4, 0, 5, 6, 4, 4, 0, 2, 5, 5, 2, 1, 4, 6, 3, 3, 3, 2, 5, 1, 6, 5, 3, 1, 4, 6, 3, 1, 2, 5, 1, 5, 1], [6, 1, 5, 3, 2, 3, 5, 3, 5, 2, 1, 0, 1, 2, 2, 4, 4, 1, 6, 2, 5, 0, 6, 4, 6, 5, 6, 0, 6, 5, 4, 4, 5, 4, 3, 1, 1, 1, 0, 2, 3, 0, 6, 2, 4, 0, 6, 1, 6, 5, 5, 2, 6, 3, 4, 2, 5, 0, 5, 5, 5, 0, 6, 3, 3, 2, 5, 1, 1, 4, 4, 1, 5, 1, 6, 0, 5, 3, 6, 4, 2, 1, 0, 0, 4, 2, 3, 5, 3, 5, 1, 3, 5, 3, 5, 6, 4, 0, 0, 4]]
ct = b'\xf7\xfd\thn\xc0="\xed\x15\xa4\x9e\xba\x18k\xf1\x92\xb2~\x14\xcc\n\xc1\xb2\xa4F\x13\x89\xaa</!7\xb5\x03Z\xcd6\xbd\x12\x04\xf6\xd7\x84\xbb0\x14f'
iv = b'l"\xf8uy\xeai\xc2@\xc4\xdbPo\x16w\x0e'


# seed = [123, 152, 251, 55, 255, 220, 44, 120, 65, 245, 237, 158, 59, 1, 151, 31, 213, 21, 199, 206, 136, 11, 246, 113, 250, 156, 153, 36, 181, 100, 30, 120, 9, 41, 22, 224, 72, 16, 191, 164, 195, 114, 217, 214, 60, 224, 103, 213, 252, 221, 170, 128, 141, 71, 219, 10, 165, 183, 18, 159, 35, 72, 133, 228]
# v = [6, 5, 4, 4, 4, 3, 4, 5, 4, 3, 5, 3, 5, 2, 0, 0, 6, 0, 1, 1, 5, 4, 1, 6, 4, 3, 3, 0, 0, 5, 6, 3, 0, 0, 1, 0, 2, 2, 2, 0, 1, 2, 0, 2, 4, 3, 4, 3, 0, 3, 2, 5, 5, 1, 6, 0, 3, 4, 5, 2, 2, 5, 0, 1, 3, 3, 1, 4, 1, 6, 3, 6, 6, 6, 0, 1, 2, 5, 1, 1, 0, 3, 1, 3, 6, 3, 2, 3, 6, 1, 4, 3, 0, 1, 0, 0, 2, 3, 1, 6]
# coms = [[6, 3, 4, 4, 5, 2, 2, 5, 4, 3, 6, 1, 0, 5, 4, 3, 1, 0, 5, 1, 3, 5, 2, 3, 6, 1, 3, 3, 5, 2, 5, 0, 1, 0, 1, 5, 4, 2, 6, 5, 2, 5, 4, 6, 4, 6, 1, 3, 4, 5, 3, 2, 3, 6, 5, 2, 0, 1, 4, 4, 4, 0, 0, 6, 2, 0, 1, 0, 1, 3, 1, 2, 5, 2, 1, 3, 2, 5, 5, 2, 2, 6, 2, 4, 3, 2, 3, 0, 0, 3, 2, 2, 0, 3, 2, 5, 6, 1, 6, 6], [2, 6, 3, 2, 1, 0, 1, 4, 4, 3, 4, 1, 1, 2, 4, 1, 3, 5, 6, 0, 3, 5, 1, 4, 2, 4, 3, 3, 2, 0, 0, 2, 4, 4, 5, 1, 5, 1, 1, 5, 0, 1, 1, 2, 1, 2, 5, 3, 6, 5, 0, 4, 3, 0, 1, 6, 4, 6, 1, 5, 5, 2, 3, 3, 3, 0, 4, 5, 4, 0, 5, 6, 6, 2, 2, 0, 1, 2, 1, 4, 1, 1, 0, 1, 6, 6, 5, 3, 4, 4, 1, 4, 2, 2, 2, 1, 1, 6, 2, 5], [3, 3, 0, 6, 3, 6, 4, 1, 6, 3, 2, 2, 0, 6, 0, 5, 3, 3, 1, 2, 6, 2, 3, 6, 5, 5, 5, 1, 3, 0, 3, 0, 4, 3, 5, 2, 1, 1, 2, 3, 3, 6, 6, 2, 3, 2, 0, 3, 6, 1, 3, 1, 2, 5, 4, 6, 4, 6, 3, 3, 6, 2, 4, 6, 2, 3, 2, 0, 5, 6, 2, 0, 5, 5, 3, 6, 4, 1, 2, 3, 0, 4, 2, 4, 3, 4, 0, 0, 1, 1, 4, 3, 0, 4, 5, 5, 6, 1, 4, 4], [6, 0, 2, 3, 0, 2, 5, 1, 3, 3, 4, 2, 3, 5, 3, 2, 2, 4, 0, 4, 4, 6, 4, 2, 3, 0, 3, 0, 6, 2, 5, 6, 4, 1, 3, 1, 0, 4, 4, 0, 2, 5, 5, 6, 1, 2, 2, 4, 5, 4, 2, 2, 6, 1, 5, 3, 5, 6, 2, 2, 5, 6, 4, 4, 2, 5, 4, 5, 0, 2, 3, 2, 5, 0, 3, 4, 4, 5, 0, 5, 2, 2, 6, 1, 3, 2, 3, 6, 3, 3, 3, 5, 1, 4, 1, 3, 4, 3, 4, 0], [2, 2, 2, 5, 5, 6, 3, 2, 6, 4, 5, 1, 3, 4, 6, 4, 0, 1, 3, 2, 5, 1, 2, 2, 5, 6, 4, 4, 4, 0, 5, 2, 6, 1, 0, 2, 5, 4, 0, 5, 4, 2, 6, 1, 6, 0, 5, 3, 1, 2, 3, 0, 0, 2, 2, 4, 2, 6, 4, 0, 0, 6, 4, 0, 0, 2, 0, 3, 1, 0, 1, 4, 5, 1, 2, 1, 3, 0, 6, 4, 1, 6, 3, 4, 3, 1, 2, 2, 6, 5, 5, 1, 2, 0, 0, 1, 1, 0, 2, 6], [2, 3, 4, 6, 1, 5, 3, 6, 4, 2, 6, 6, 0, 6, 0, 2, 2, 4, 1, 2, 3, 2, 0, 1, 2, 0, 2, 5, 6, 3, 0, 1, 3, 5, 3, 6, 4, 2, 5, 1, 2, 5, 3, 2, 1, 5, 4, 6, 4, 5, 0, 0, 6, 2, 3, 4, 2, 5, 6, 0, 2, 3, 0, 3, 6, 2, 4, 5, 6, 3, 1, 3, 6, 4, 0, 6, 5, 5, 6, 4, 4, 3, 3, 2, 2, 1, 4, 5, 4, 0, 0, 2, 6, 4, 0, 5, 4, 4, 3, 2], [5, 6, 6, 6, 6, 2, 5, 2, 3, 2, 0, 6, 5, 1, 5, 3, 5, 3, 0, 1, 3, 3, 5, 6, 4, 1, 2, 1, 1, 4, 1, 0, 3, 2, 3, 4, 4, 2, 3, 4, 2, 6, 5, 4, 1, 5, 6, 0, 0, 3, 0, 2, 6, 4, 4, 3, 4, 2, 2, 5, 0, 2, 6, 2, 5, 5, 5, 6, 2, 2, 2, 6, 2, 5, 2, 0, 4, 3, 1, 5, 1, 3, 0, 0, 3, 5, 5, 3, 2, 4, 5, 6, 5, 6, 2, 3, 3, 6, 4, 0], [3, 6, 2, 4, 2, 2, 2, 2, 0, 3, 2, 5, 4, 5, 5, 1, 0, 3, 5, 0, 0, 4, 2, 0, 6, 1, 2, 1, 1, 3, 2, 2, 6, 4, 0, 5, 5, 2, 6, 3, 2, 3, 2, 3, 0, 1, 6, 5, 3, 0, 0, 2, 6, 2, 5, 2, 2, 5, 4, 0, 1, 4, 2, 5, 6, 2, 3, 0, 6, 1, 2, 3, 1, 4, 1, 0, 6, 0, 6, 0, 2, 0, 1, 6, 2, 6, 1, 5, 6, 4, 0, 6, 4, 3, 3, 4, 4, 4, 0, 0], [4, 4, 2, 4, 1, 6, 3, 4, 6, 0, 0, 2, 2, 3, 5, 0, 3, 0, 6, 4, 1, 3, 0, 5, 4, 0, 2, 0, 5, 0, 6, 2, 1, 0, 1, 3, 2, 2, 6, 3, 2, 1, 1, 0, 4, 5, 2, 3, 4, 4, 5, 1, 3, 2, 1, 3, 5, 5, 4, 4, 4, 4, 4, 6, 5, 3, 6, 2, 2, 6, 3, 6, 0, 6, 0, 4, 2, 4, 4, 3, 0, 0, 0, 5, 5, 2, 4, 2, 5, 1, 3, 1, 1, 0, 1, 1, 3, 4, 1, 1]]
# tass = [[2, 0, 2, 1, 1, 4, 6, 5, 1, 4, 2, 0, 4, 2, 0, 4, 4, 4, 3, 4, 2, 2, 2, 6, 3, 2, 6, 4, 4, 3, 5, 3, 0, 0, 4, 6, 3, 6, 1, 1, 4, 5, 3, 1, 4, 6, 3, 4, 1, 2, 0, 0, 3, 5, 4, 0, 4, 6, 1, 3, 3, 4, 4, 1, 0, 0, 1, 4, 2, 2, 4, 4, 4, 3, 6, 1, 1, 0, 1, 4, 0, 4, 4, 5, 2, 5, 2, 5, 0, 1, 4, 3, 2, 1, 0, 6, 4, 6, 2, 6], [1, 3, 0, 6, 3, 4, 4, 2, 1, 5, 2, 5, 1, 6, 5, 4, 0, 6, 4, 2, 2, 5, 4, 5, 4, 3, 1, 1, 2, 0, 5, 1, 0, 5, 5, 2, 1, 4, 4, 1, 1, 6, 2, 4, 0, 1, 2, 1, 6, 0, 6, 1, 0, 3, 3, 3, 0, 4, 6, 3, 6, 1, 5, 0, 2, 1, 2, 2, 4, 3, 4, 6, 2, 4, 5, 1, 4, 0, 0, 1, 0, 5, 6, 6, 2, 3, 2, 3, 5, 2, 3, 0, 4, 3, 3, 2, 1, 6, 5, 0], [6, 5, 0, 2, 4, 1, 0, 4, 0, 4, 6, 0, 0, 1, 0, 3, 5, 5, 2, 3, 1, 6, 5, 1, 5, 6, 3, 6, 3, 1, 4, 3, 4, 2, 0, 1, 3, 0, 1, 2, 2, 1, 6, 2, 4, 2, 1, 4, 4, 2, 0, 1, 2, 0, 6, 5, 5, 5, 6, 6, 1, 5, 0, 3, 6, 1, 5, 1, 3, 5, 1, 4, 6, 5, 1, 1, 3, 1, 3, 1, 1, 1, 3, 1, 6, 4, 1, 5, 2, 0, 6, 1, 3, 3, 0, 5, 2, 0, 0, 5], [2, 0, 2, 0, 6, 4, 3, 3, 3, 0, 6, 0, 6, 1, 1, 2, 5, 0, 2, 1, 5, 0, 2, 2, 0, 3, 0, 0, 4, 2, 3, 1, 3, 5, 3, 2, 5, 0, 4, 3, 1, 1, 5, 1, 0, 5, 4, 0, 6, 1, 5, 2, 0, 4, 2, 0, 4, 4, 1, 2, 4, 0, 2, 1, 0, 2, 4, 5, 6, 5, 6, 4, 4, 3, 6, 0, 5, 6, 5, 5, 6, 1, 6, 5, 6, 4, 3, 0, 5, 3, 4, 3, 4, 6, 1, 3, 3, 5, 5, 1], [3, 5, 1, 1, 4, 4, 3, 0, 5, 3, 1, 2, 1, 0, 4, 2, 5, 2, 4, 6, 5, 5, 4, 4, 0, 1, 4, 0, 0, 5, 0, 6, 1, 2, 0, 4, 1, 4, 3, 5, 5, 5, 6, 2, 2, 3, 0, 5, 0, 6, 1, 3, 1, 6, 4, 2, 6, 2, 1, 0, 2, 3, 6, 2, 6, 4, 3, 2, 1, 5, 6, 5, 2, 5, 0, 5, 0, 4, 5, 4, 2, 3, 3, 5, 3, 2, 1, 6, 5, 3, 0, 5, 6, 5, 1, 4, 2, 0, 4, 3], [1, 6, 2, 0, 6, 2, 0, 4, 3, 0, 2, 5, 5, 5, 6, 1, 1, 6, 4, 4, 6, 1, 1, 2, 1, 4, 0, 2, 4, 4, 1, 2, 2, 5, 0, 1, 6, 2, 4, 4, 4, 4, 4, 6, 2, 4, 2, 1, 4, 6, 5, 5, 3, 3, 4, 2, 1, 1, 3, 3, 5, 6, 2, 0, 2, 4, 1, 5, 5, 2, 3, 3, 2, 0, 4, 0, 6, 2, 4, 5, 2, 1, 6, 2, 1, 1, 2, 2, 4, 4, 3, 2, 5, 2, 4, 1, 6, 2, 2, 1], [0, 1, 4, 6, 2, 2, 5, 3, 4, 1, 4, 0, 4, 1, 4, 3, 1, 5, 0, 2, 1, 3, 2, 1, 1, 3, 5, 4, 6, 1, 5, 1, 2, 0, 3, 3, 1, 3, 4, 6, 1, 2, 4, 5, 3, 1, 3, 2, 1, 5, 2, 3, 1, 5, 2, 1, 4, 4, 0, 0, 1, 5, 3, 3, 5, 6, 0, 1, 3, 2, 1, 0, 1, 6, 4, 3, 1, 2, 2, 2, 6, 3, 6, 6, 4, 6, 3, 3, 1, 6, 5, 2, 3, 6, 2, 6, 0, 5, 6, 2], [3, 6, 4, 5, 5, 2, 2, 0, 6, 0, 4, 6, 6, 4, 6, 2, 3, 6, 3, 0, 0, 1, 1, 4, 5, 0, 5, 2, 1, 5, 1, 2, 6, 5, 6, 6, 4, 4, 3, 1, 3, 0, 3, 4, 1, 1, 6, 2, 1, 6, 6, 4, 6, 5, 5, 4, 2, 6, 0, 0, 6, 3, 0, 0, 4, 1, 6, 2, 5, 1, 2, 0, 1, 6, 1, 5, 4, 1, 1, 3, 1, 1, 5, 3, 0, 3, 4, 1, 0, 2, 2, 6, 1, 1, 1, 0, 1, 2, 6, 3], [1, 4, 1, 0, 0, 5, 6, 1, 1, 4, 2, 4, 3, 0, 6, 0, 0, 1, 0, 2, 3, 3, 1, 5, 1, 6, 2, 3, 0, 5, 5, 1, 1, 1, 2, 2, 6, 4, 4, 2, 3, 1, 5, 2, 2, 6, 2, 4, 2, 4, 1, 2, 4, 1, 4, 3, 0, 0, 2, 4, 2, 4, 5, 4, 3, 4, 6, 2, 5, 6, 5, 3, 5, 2, 1, 1, 0, 3, 5, 1, 3, 5, 5, 0, 6, 5, 2, 5, 4, 6, 4, 2, 6, 0, 5, 2, 5, 1, 2, 2]]
# verifs = [[4, 6, 4, 4, 6, 4, 4, 1, 0, 1, 4, 4, 3, 2, 1, 5, 3, 6, 0, 3, 4, 3, 3, 5, 3, 3, 1, 5, 4, 4, 1, 5, 2, 2, 0, 6, 5, 5, 6, 1, 0, 4, 6, 6, 0, 0, 2, 5, 5, 5, 3, 1, 0, 3, 3, 2, 4, 4, 1, 4, 5, 0, 6, 1, 4, 3, 4, 3, 3, 0, 3, 2, 6, 1, 1, 2, 4, 5, 0, 1, 5, 3, 0, 3, 3, 2, 2, 4, 2, 5, 2, 4, 5, 1, 3, 2, 6, 3, 2, 4], [0, 1, 0, 4, 3, 6, 3, 3, 6, 0, 4, 6, 4, 6, 3, 1, 0, 1, 5, 4, 3, 6, 4, 1, 0, 4, 5, 6, 5, 3, 6, 1, 3, 4, 0, 3, 3, 6, 1, 4, 0, 0, 1, 6, 2, 4, 3, 5, 5, 2, 1, 0, 2, 1, 4, 0, 1, 3, 3, 2, 1, 3, 0, 2, 3, 1, 4, 6, 0, 0, 6, 2, 4, 6, 4, 4, 2, 4, 2, 5, 6, 2, 0, 4, 6, 4, 1, 5, 4, 1, 3, 5, 0, 3, 5, 5, 0, 2, 3, 3], [0, 5, 6, 4, 5, 1, 4, 4, 1, 1, 6, 3, 1, 3, 3, 0, 1, 1, 6, 5, 1, 2, 0, 5, 5, 3, 3, 6, 4, 5, 4, 5, 2, 2, 3, 2, 6, 4, 2, 1, 3, 5, 1, 4, 4, 3, 3, 5, 3, 4, 1, 0, 6, 6, 1, 1, 6, 5, 6, 5, 6, 5, 1, 1, 3, 1, 2, 5, 2, 3, 5, 3, 0, 6, 1, 2, 5, 5, 6, 0, 0, 5, 0, 1, 0, 0, 3, 0, 6, 5, 5, 6, 3, 3, 0, 2, 3, 4, 4, 3], [2, 3, 3, 4, 0, 0, 1, 3, 6, 2, 2, 0, 4, 4, 2, 5, 0, 4, 3, 1, 1, 4, 5, 4, 3, 5, 2, 5, 5, 0, 4, 1, 0, 0, 6, 5, 2, 1, 4, 2, 1, 0, 2, 0, 6, 0, 3, 2, 4, 1, 0, 6, 2, 0, 0, 1, 1, 3, 6, 2, 4, 3, 5, 6, 0, 2, 4, 0, 6, 2, 4, 5, 4, 5, 1, 1, 0, 2, 5, 3, 0, 3, 3, 6, 2, 0, 3, 3, 1, 2, 2, 3, 1, 5, 4, 0, 6, 4, 5, 6], [2, 6, 0, 3, 4, 0, 4, 0, 4, 4, 0, 1, 4, 4, 3, 0, 1, 0, 3, 1, 4, 4, 6, 6, 6, 5, 1, 4, 4, 0, 5, 4, 6, 2, 4, 3, 2, 3, 2, 1, 4, 2, 4, 0, 3, 0, 3, 3, 5, 1, 4, 3, 0, 6, 0, 3, 3, 3, 4, 6, 6, 5, 0, 0, 0, 3, 3, 6, 4, 6, 6, 1, 4, 4, 4, 1, 2, 4, 2, 6, 5, 5, 3, 5, 5, 1, 6, 0, 1, 0, 0, 3, 6, 2, 6, 0, 4, 1, 6, 4], [4, 0, 1, 2, 2, 1, 0, 3, 1, 1, 1, 4, 4, 4, 0, 5, 1, 2, 1, 3, 3, 3, 0, 5, 3, 4, 0, 2, 1, 6, 1, 5, 4, 0, 3, 6, 6, 1, 0, 3, 6, 3, 2, 0, 6, 0, 5, 1, 6, 1, 3, 5, 5, 2, 3, 1, 3, 4, 5, 5, 1, 0, 4, 3, 2, 4, 3, 2, 1, 0, 4, 0, 6, 3, 0, 3, 1, 6, 6, 0, 0, 6, 5, 1, 4, 3, 3, 2, 5, 4, 0, 3, 6, 3, 1, 0, 5, 1, 2, 6], [6, 0, 6, 3, 2, 2, 2, 5, 2, 2, 4, 6, 6, 4, 3, 2, 4, 6, 5, 5, 1, 1, 4, 0, 5, 0, 5, 6, 6, 1, 2, 3, 0, 5, 6, 3, 5, 4, 4, 0, 4, 4, 5, 0, 1, 5, 4, 3, 2, 1, 1, 0, 3, 6, 1, 6, 6, 2, 6, 3, 0, 5, 1, 3, 3, 6, 4, 3, 2, 2, 5, 1, 1, 2, 2, 1, 4, 3, 5, 6, 0, 6, 6, 1, 1, 3, 1, 1, 4, 0, 6, 3, 6, 5, 5, 2, 6, 5, 0, 2], [5, 4, 2, 1, 1, 6, 4, 3, 1, 3, 5, 1, 3, 1, 5, 6, 5, 4, 1, 4, 6, 4, 0, 2, 4, 0, 2, 3, 2, 2, 5, 4, 1, 3, 6, 2, 4, 4, 6, 1, 4, 6, 6, 2, 2, 5, 1, 6, 6, 5, 2, 5, 4, 0, 6, 4, 3, 4, 4, 6, 2, 6, 3, 1, 3, 0, 0, 3, 5, 0, 0, 6, 0, 2, 5, 3, 0, 4, 5, 4, 3, 2, 1, 6, 6, 6, 4, 3, 1, 2, 5, 6, 4, 1, 1, 5, 3, 1, 3, 4], [5, 4, 4, 1, 1, 1, 6, 5, 4, 5, 2, 5, 3, 3, 4, 0, 4, 3, 6, 5, 4, 0, 2, 3, 0, 3, 1, 3, 1, 1, 4, 0, 5, 0, 1, 5, 2, 2, 6, 0, 1, 1, 4, 2, 0, 2, 3, 2, 2, 5, 6, 5, 2, 3, 1, 6, 3, 4, 0, 4, 4, 4, 3, 2, 1, 5, 3, 4, 1, 2, 0, 4, 2, 5, 3, 6, 5, 2, 0, 3, 4, 4, 0, 6, 4, 6, 3, 0, 5, 3, 0, 1, 0, 6, 5, 0, 0, 4, 5, 4]]
# ct = b'\xe9\xf4\xccd.\xab\xc9Mm\n|\xd2\x9b5\x07\nCr\xd1\xeco\xedO\xa30\xb8\xb2&C>7E'
# iv = b'\x82b\xddv\xaf\xad\x8f\x13@\x12\xa0\xd9\x8co8\xae'

gen_seed = bytes(seed)
# s = [3, 1, 3, 1, 5, 0, 5, 6, 2, 1, 3, 5, 3, 6, 6, 4, 3, 4, 4, 1, 4, 2, 4, 5, 5, 6, 0, 2, 2, 0, 1, 3, 1, 0, 4, 1, 1, 1, 4, 5, 3, 1, 6, 4, 2, 5, 6, 5, 1, 0, 0, 2, 6, 3, 4, 0, 6, 1, 2, 4, 0, 6, 0, 6, 6, 1, 2, 3, 2, 5, 6, 1, 3, 0, 1, 6, 5, 4, 5, 3, 4, 3, 2, 1, 1, 0, 0, 6, 1, 3, 0, 2, 3, 3, 1, 2, 5, 0, 2, 0]

F = []
FF = GF(7)
for i in range(m):
    cur = []
    for j in range(n):
        cur.append([])
        for k in range(n):
            cur[-1].append(sha256(gen_seed).digest()[0] % q)
            gen_seed = sha256(gen_seed).digest()
    F.append(matrix(FF, n, n, cur))
def decrypt_flag(s, enc, iv):
    key = sha256(str([int(i) for i in s.list()]).encode()).digest()
    cipher = AES.new(key, AES.MODE_CBC, iv)
    ct = cipher.decrypt(enc)
    return ct

def apply1(F, v):
    out = []
    for i in range(m):
        out.append((v.T * F[i] * v)[0, 0])
    return matrix(FF, out).T


coms = [matrix(FF, 100, 1, com) for com in coms]
verifs = [matrix(FF,100, 1,verif) for verif in verifs]
tass = [matrix(FF,100, 1,tas) for tas in tass]
v = matrix(FF, 100, 1, v)
# print(tass[-1].list())
for _ in range(9):
	a = sha256(bytes([int(i) for i in coms[_].list() + v.list() + verifs[_].list()])).digest()[0] % q
	print(a)
# s = matrix(FF, 100, 1, s)
mat = []
for k in range(100):
	tmp = (tass[2].T - tass[3].T) * (F[k] + F[k].T) 
	mat.append(list(tmp[0]))
mat = matrix(FF, mat)
# print(mat*s==verifs[-1])
s = (~mat) * (verifs[2] - verifs[3])
# print(s)

print(decrypt_flag(s, ct,iv))
# except:
# 	io.close()
# 	continue
# pok = create_pok(v, s, F)
# m0 = [i[0] for i in list(pok[0])]
# m1 = [i[0] for i in list(pok[1])]
# m2 = [i[0] for i in list(pok[2])]
# print(m0)
# print(m1)
# print(m2)

# io.sendlineafter(b'm0 =', str(m0).encode())
# io.sendlineafter(b'm1 =', str(m1).encode())
# io.sendlineafter(b'm2 =', str(m2).encode())
# io.interactive()