from Crypto.Util.number import *
from Crypto.PublicKey import RSA 

# Đọc khóa riêng tư từ tệp PEM
with open('priv.pem', 'rb') as f:
    private_key = RSA.import_key(f.read())


n = 17977531016322069414195193190087403712723934918217706606804214725841531392461016798345316334312107538289392671097559511056192165189219173393590646533376068049452209349561216148033590516093645141486990220481170174389131990704691904487255540179142091900657389534360644991879347804967884822367091695163184679838140135514722125633036900036000456344923687421261307699014682561026016403506940659111223695033813938696519606046151174148746962652767542348878434718880843231241378968960604505770944416129231373390600671100414654836320318012806564781549253201961967440965023072858883062083469521147437479923589352410511442071287
e = 0x010001
enc = bytes_to_long(open("flag.txt.enc", "rb").read())
p = private_key.p
q = private_key.q
print(long_to_bytes(pow(enc, pow(e, -1, (p-1)*(q-1)), n)))